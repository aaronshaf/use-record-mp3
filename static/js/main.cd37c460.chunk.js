(this["webpackJsonpuse-record-mp3-example"]=this["webpackJsonpuse-record-mp3-example"]||[]).push([[0],{11:function(e,t,n){e.exports=n(21)},12:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);n(12);var r=n(0),a=n.n(r),c=n(8),u=n.n(c),o=n(6),i=n(9),l=n.n(i),s=n(1),b=n(10);var f=new Uint8Array(1048576),d=window.AudioContext||window.webkitAudioContext,p=function(e){var t=Object(r.useState)(!1),n=Object(s.a)(t,2),a=n[0],c=n[1],u=Object(r.useState)(null),o=Object(s.a)(u,2),i=o[0],l=o[1],p=Object(r.useState)(null),j=Object(s.a)(p,2),v=j[0],O=j[1],h=Object(r.useRef)(0),m=Object(r.useRef)([]),g=Object(r.useState)(null),w=Object(s.a)(g,2),y=w[0],S=w[1],R=Object(r.useRef)(null),x=function(e){var t=Object(r.useState)(null),n=Object(s.a)(t,2),a=n[0],c=n[1],u=Object(r.useState)(null),o=Object(s.a)(u,2),i=o[0],l=o[1],d=Object(r.useMemo)((function(){return Object(b.a)()}),[]);return Object(r.useEffect)((function(){e&&d.then((function(t){t.configure({sampleRate:48e3,channels:1,vbrQuality:1});for(var n=0,r=!0;;){var a=r?t.encode([e]):t.finalize();if(a.length+n>f.length){var u=new Uint8Array(a.length+n);u.set(f),f=u}if(f.set(a,n),n+=a.length,!r)break;r=!1}var o=new Uint8Array(f.buffer,0,n),i=new Blob([new Uint8Array(o).buffer],{type:"audio/mpeg"}),s=URL.createObjectURL(i);c(i),l(s)}))}),[e]),[i,a]}(y),E=Object(s.a)(x,2),k=E[0],A=E[1];return Object(r.useEffect)((function(){if(a&&e){S(null),R.current=new d;var t,n=R.current;(t=n.createScriptProcessor?n.createScriptProcessor(2048,1,1):n.createJavaScriptNode(2048,1,1)).onaudioprocess=function(e){var t=new Float32Array(e.inputBuffer.getChannelData(0));m.current.push(t),h.current=h.current+2048},O(t);var r=n.createMediaStreamSource(e);l(r),r.connect(t),t.connect(n.destination)}else if(!1===a&&v&&i&&R.current){v&&v.disconnect(R.current.destination),i&&i.disconnect(v);var c=function(e,t){for(var n=new Float32Array(t),r=0,a=0;a<e.length;a++){var c=e[a];n.set(c,r),r+=c.length}return n}(m.current,h.current);S(c)}}),[a]),{isRecording:a,setIsRecording:c,blobUrl:k,blob:A,channelData:y}},j=n(7);function v(){var e=Object(o.a)(["pt-4"]);return v=function(){return e},e}function O(){var e=Object(o.a)(["px-4 py-2 border border-black rounded text-lg"]);return O=function(){return e},e}function h(){var e=Object(o.a)(["p-6"]);return h=function(){return e},e}var m={audio:{}},g=function(){var e=l()(m).stream,t=p(e),n=t.isRecording,r=t.setIsRecording,c=t.blobUrl,u=t.channelData,o=(u?function(e){for(var t=Math.floor(e.length/1e3),n=[],r=0;r<1e3;r++){for(var a=t*r,c=0,u=0;u<t;u++)c+=Math.abs(e[a+u]);n.push(c/t)}return n}(u):[]).map((function(e,t){return a.a.createElement("div",{key:t,style:{width:"0.1%",height:"".concat(100*e,"%"),backgroundColor:"red"}})}));return a.a.createElement("div",{className:Object(j.a)(h())},a.a.createElement("button",{className:Object(j.a)(O()),onClick:function(){return r(!n)}},n?"Stop":"Record"),c&&a.a.createElement("div",{className:Object(j.a)(v())},a.a.createElement("audio",{controls:!0,src:c}),a.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"300px",height:"100px"}},o)))};u.a.render(a.a.createElement(g,null),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.cd37c460.chunk.js.map