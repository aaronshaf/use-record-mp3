(this["webpackJsonpuse-record-mp3-example"]=this["webpackJsonpuse-record-mp3-example"]||[]).push([[0],{15:function(e,t,n){"use strict";n.r(t);n(6);var r=n(0),c=n.n(r),a=n(2),o=n.n(a),u=n(3),i=n.n(u),l=n(4);var s=new Uint8Array(1048576),f=window.AudioContext||window.webkitAudioContext,d=function(e){var t=Object(r.useState)(!1),n=t[0],c=t[1],a=Object(r.useState)(null),o=a[0],u=a[1],i=Object(r.useState)(null),d=i[0],b=i[1],h=Object(r.useRef)(0),p=Object(r.useRef)([]),v=Object(r.useState)(null),g=v[0],m=v[1],w=Object(r.useRef)(null),j=function(e){var t=Object(r.useState)(null),n=t[0],c=t[1],a=Object(r.useState)(null),o=a[0],u=a[1],i=Object(r.useMemo)((function(){return Object(l.a)()}),[]);return Object(r.useEffect)((function(){e&&i.then((function(t){t.configure({sampleRate:48e3,channels:1,vbrQuality:1});for(var n=0,r=!0;;){var a=r?t.encode([e]):t.finalize();if(a.length+n>s.length){var o=new Uint8Array(a.length+n);o.set(s),s=o}if(s.set(a,n),n+=a.length,!r)break;r=!1}var i=new Uint8Array(s.buffer,0,n),l=new Blob([new Uint8Array(i).buffer],{type:"audio/mpeg"}),f=URL.createObjectURL(l);c(l),u(f)}))}),[e]),[o,n]}(g),O=j[0],y=j[1];return Object(r.useEffect)((function(){if(n&&e){m(null),w.current=new f;var t,r=w.current;(t=r.createScriptProcessor?r.createScriptProcessor(2048,1,1):r.createJavaScriptNode(2048,1,1)).onaudioprocess=function(e){var t=new Float32Array(e.inputBuffer.getChannelData(0));p.current.push(t),h.current=h.current+2048},b(t);var c=r.createMediaStreamSource(e);u(c),c.connect(t),t.connect(r.destination)}else if(!1===n&&d&&o&&w.current){d&&d.disconnect(w.current.destination),o&&o.disconnect(d);var a=function(e,t){for(var n=new Float32Array(t),r=0,c=0;c<e.length;c++){var a=e[c];n.set(a,r),r+=a.length}return n}(p.current,h.current);m(a)}}),[n]),{isRecording:n,setIsRecording:c,blobUrl:O,blob:y,channelData:g}},b={audio:{channelCount:2}},h=function(){var e=i()(b).stream,t=d(e),n=t.isRecording,r=t.setIsRecording,a=t.blobUrl,o=t.channelData,u=(o?function(e){for(var t=Math.floor(e.length/1e3),n=[],r=0;r<1e3;r++){for(var c=t*r,a=0,o=0;o<t;o++)a+=Math.abs(e[c+o]);n.push(a/t)}return n}(o):[]).map((function(e,t){return c.a.createElement("div",{key:t,style:{width:"0.1%",height:"".concat(100*e,"%"),backgroundColor:"red"}})}));return c.a.createElement("div",null,c.a.createElement("button",{onClick:function(){return r(!n)}},n?"Stop":"Record"),a&&c.a.createElement("audio",{controls:!0,src:a}),c.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"300px",height:"100px"}},u))};o.a.render(c.a.createElement(h,null),document.getElementById("root"))},5:function(e,t,n){e.exports=n(15)},6:function(e,t,n){}},[[5,1,2]]]);
//# sourceMappingURL=main.5b88ec9b.chunk.js.map