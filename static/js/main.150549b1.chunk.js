(this["webpackJsonpuse-record-mp3-example"]=this["webpackJsonpuse-record-mp3-example"]||[]).push([[0],{12:function(e,t,n){e.exports=n(24)},13:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);n(13);var r=n(0),a=n.n(r),c=n(8),o=n.n(c),u=n(4),i=n(9),s=n.n(i),l=n(1),b=n(11);var d=new Uint8Array(1048576),f=window.AudioContext||window.webkitAudioContext,p=function(e,t){var n=Object(r.useState)(!1),a=Object(l.a)(n,2),c=a[0],o=a[1],u=Object(r.useState)(!1),i=Object(l.a)(u,2),s=i[0],p=i[1],m=Object(r.useState)(null),h=Object(l.a)(m,2),j=h[0],O=h[1],g=Object(r.useState)(null),v=Object(l.a)(g,2),R=v[0],w=v[1],y=Object(r.useRef)(0),x=Object(r.useRef)([]),k=Object(r.useState)(null),E=Object(l.a)(k,2),S=E[0],A=E[1],U=Object(r.useRef)(null),C=function(e,t){var n=Object(r.useState)(null),a=Object(l.a)(n,2),c=a[0],o=a[1],u=Object(r.useState)(null),i=Object(l.a)(u,2),s=i[0],f=i[1],p=Object(r.useMemo)((function(){return Object(b.a)()}),[]);return Object(r.useEffect)((function(){e&&p.then((function(n){n.configure(t.bitrate?{sampleRate:t.sampleRate||48e3,channels:t.channels||1,bitrate:t.bitrate}:{sampleRate:t.sampleRate||48e3,channels:t.channels||1,vbrQuality:t.vbrQuality||2});for(var r=0,a=!0;;){var c=a?n.encode([e]):n.finalize();if(c.length+r>d.length){var u=new Uint8Array(c.length+r);u.set(d),d=u}if(d.set(c,r),r+=c.length,!a)break;a=!1}var i=new Uint8Array(d.buffer,0,r),s=new Blob([new Uint8Array(i).buffer],{type:"audio/mpeg"}),l=URL.createObjectURL(s);o(s),f(l)}))}),[e]),[s,c]}(S,t),N=Object(l.a)(C,2),P=N[0],M=N[1];return Object(r.useEffect)((function(){if(!1===c&&R&&j&&U.current){R&&R.disconnect(U.current.destination),j&&j.disconnect(R);var e=function(e,t){for(var n=new Float32Array(t),r=0,a=0;a<e.length;a++){var c=e[a];n.set(c,r),r+=c.length}return n}(x.current,y.current);A(e)}}),[c]),{isRecording:c,isRecordingPaused:s,startRecording:function(){if(e){o(!0),s||(y.current=0,x.current=[]),p(!1),U.current=new f;var t,n=U.current;(t=n.createScriptProcessor?n.createScriptProcessor(2048,1,1):n.createJavaScriptNode(2048,1,1)).onaudioprocess=function(e){var t=new Float32Array(e.inputBuffer.getChannelData(0));x.current.push(t),y.current=y.current+2048},w(t);var r=n.createMediaStreamSource(e);O(r),r.connect(t),t.connect(n.destination)}},stopRecording:function(){o(!1),p(!1)},pauseRecording:function(){o(!1),p(!0)},blobUrl:P,blob:M,channelData:S}},m=n(5),h=n(10),j=n.n(h);function O(){var e=Object(u.a)(["pt-4"]);return O=function(){return e},e}function g(){var e=Object(u.a)(["px-4 py-2 border border-black rounded text-lg"]);return g=function(){return e},e}function v(){var e=Object(u.a)(["px-4 mr-1 py-2 border border-black rounded text-lg"]);return v=function(){return e},e}function R(){var e=Object(u.a)(["px-4 mr-1 py-2 border border-black rounded text-lg"]);return R=function(){return e},e}function w(){var e=Object(u.a)(["p-6"]);return w=function(){return e},e}var y={audio:!0},x=function(){var e=s()(y).stream,t=p(e,{sampleRate:48e3,channels:1,bitrate:96}),n=t.isRecording,r=t.isRecordingPaused,c=t.startRecording,o=t.stopRecording,u=t.pauseRecording,i=t.blobUrl,l=t.channelData,b=(l?function(e){for(var t=Math.floor(e.length/1e3),n=[],r=0;r<1e3;r++){for(var a=t*r,c=0,o=0;o<t;o++)c+=Math.abs(e[a+o]);n.push(c/t)}return n}(l):[]).map((function(e,t){return a.a.createElement("div",{key:t,style:{width:"0.1%",height:"".concat(100*e,"%"),backgroundColor:"red"}})}));return a.a.createElement("div",{className:Object(m.a)(w())},a.a.createElement("button",{disabled:n,className:Object(m.a)(R()),onClick:c},"Record"),a.a.createElement("button",{disabled:!(n||!n&&r),className:Object(m.a)(v()),onClick:o},"Stop"),a.a.createElement("button",{disabled:!n&&!r,className:Object(m.a)(g()),onClick:r?c:u},"Pause"),i&&a.a.createElement("div",{className:Object(m.a)(O())},a.a.createElement("audio",{controls:!0,src:i}),a.a.createElement("div",{style:{display:"flex",alignItems:"center",width:"300px",height:"100px"}},b)),a.a.createElement(j.a,{color:"black",position:"right",href:"https://github.com/aaronshaf/use-record-mp3"},"GitHub repo"))};o.a.render(a.a.createElement(x,null),document.getElementById("root"))}},[[12,1,2]]]);
//# sourceMappingURL=main.150549b1.chunk.js.map